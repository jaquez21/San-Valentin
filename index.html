<script>
const fotos = document.querySelectorAll('.foto-circular');
const limite = 260;
const size = 80;

const objetos = [];

// POSICIONES INICIALES DISTRIBUIDAS (para que no se tapen)
const posicionesIniciales = [
  {x: 10, y: 10},
  {x: 160, y: 10},
  {x: 10, y: 160},
  {x: 160, y: 160},
  {x: 85, y: 40},
  {x: 40, y: 110}
];

fotos.forEach((foto, i) => {

  let pos = posicionesIniciales[i % posicionesIniciales.length];

  let x = pos.x;
  let y = pos.y;

  // UN CHIN MÁS RÁPIDO (pero romántico)
  let dx = (Math.random() * 0.7 + 0.6) * (Math.random() < 0.5 ? 1 : -1);
  let dy = (Math.random() * 0.7 + 0.6) * (Math.random() < 0.5 ? 1 : -1);

  objetos.push({ foto, x, y, dx, dy });

  foto.style.left = x + "px";
  foto.style.top = y + "px";
});

function animar() {

  // Movimiento
  objetos.forEach(obj => {
    obj.x += obj.dx;
    obj.y += obj.dy;

    // Rebote contra paredes
    if (obj.x <= 0 || obj.x + size >= limite) obj.dx *= -1;
    if (obj.y <= 0 || obj.y + size >= limite) obj.dy *= -1;
  });

  // Rebote entre imágenes
  for (let i = 0; i < objetos.length; i++) {
    for (let j = i + 1; j < objetos.length; j++) {

      let a = objetos[i];
      let b = objetos[j];

      let dx = b.x - a.x;
      let dy = b.y - a.y;
      let distancia = Math.sqrt(dx * dx + dy * dy);

      let minDist = size - 5;

      if (distancia < minDist) {

        // Intercambio suave de velocidades
        let tempDx = a.dx;
        let tempDy = a.dy;

        a.dx = b.dx;
        a.dy = b.dy;

        b.dx = tempDx;
        b.dy = tempDy;

        // Separación para evitar que se queden pegadas
        let overlap = minDist - distancia;
        let angulo = Math.atan2(dy, dx);

        let ajusteX = Math.cos(angulo) * overlap / 2;
        let ajusteY = Math.sin(angulo) * overlap / 2;

        a.x -= ajusteX;
        a.y -= ajusteY;

        b.x += ajusteX;
        b.y += ajusteY;
      }
    }
  }

  // Aplicar posiciones
  objetos.forEach(obj => {
    obj.foto.style.left = obj.x + "px";
    obj.foto.style.top = obj.y + "px";
  });

  requestAnimationFrame(animar);
}

animar();
</script>
